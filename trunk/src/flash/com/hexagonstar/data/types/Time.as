/* * hexagonlib - Multi-Purpose ActionScript 3 Library. *       __    __ *    __/  \__/  \__    __ *   /  \__/HEXAGON \__/  \ *   \__/  \__/  LIBRARY _/ *            \__/  \__/ * * Licensed under the MIT License *  * Permission is hereby granted, free of charge, to any person obtaining a copy of * this software and associated documentation files (the "Software"), to deal in * the Software without restriction, including without limitation the rights to * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of * the Software, and to permit persons to whom the Software is furnished to do so, * subject to the following conditions: *  * The above copyright notice and this permission notice shall be included in all * copies or substantial portions of the Software. *  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. */package com.hexagonstar.data.types{	import com.hexagonstar.data.constants.TimeUnit;		/**	 * The Time class provides a data type that represents a time value. Time values can	 * be specified in milliseconds, seconds, minutes, hours, days or years.	 * 	 * @example	 * <pre>	 *	var t:Time = new Time(24.3, Time.FORMAT_HOURS);	 *	trace(t.milliseconds);   // 87480000	 *	trace(t.seconds);        // 87480	 *	trace(t.minutes);        // 1458	 *	trace(t.years);          // 0.002773972602739726	 *	trace(t.getYears(3));    // 0.002	 * </pre>	 */	public class Time	{		//-----------------------------------------------------------------------------------------		// Constants		//-----------------------------------------------------------------------------------------				/**		 * Constant used to determine the time format as years.		 */		public static const FORMAT_YEARS:String = "years";				/**		 * Constant used to determine the time format as days.		 */		public static const FORMAT_DAYS:String = "days";				/**		 * Constant used to determine the time format as hours.		 */		public static const FORMAT_HOURS:String = "hours";				/**		 * Constant used to determine the time format as minutes.		 */		public static const FORMAT_MINUTES:String = "minutes";				/**		 * Constant used to determine the time format as seconds.		 */		public static const FORMAT_SECONDS:String = "seconds";				/**		 * Constant used to determine the time format as seconds.		 */		public static const FORMAT_MILLISECONDS:String = "ms";						//-----------------------------------------------------------------------------------------		// Properties		//-----------------------------------------------------------------------------------------				/** @private */		protected var _years:Number;		/** @private */		protected var _days:Number;		/** @private */		protected var _hours:Number;		/** @private */		protected var _minutes:Number;		/** @private */		protected var _seconds:Number;		/** @private */		protected var _milliSeconds:Number;		/** @private */		protected var _ms:Number;		/** @private */		protected var _doEval:Boolean;						//-----------------------------------------------------------------------------------------		// Constructor		//-----------------------------------------------------------------------------------------				/**		 * Creates a new Time instance.		 * 	     * @param value  The value of the time for the specified format.	     * @param format The format of the time.		 */		public function Time(value:Number, format:String = Time.FORMAT_MILLISECONDS)		{			setValue(value, format);		}						//-----------------------------------------------------------------------------------------		// Public Methods		//-----------------------------------------------------------------------------------------				/**		 * Sets the value of the Time.		 * 	     * @param value  The value of the time for the specified format.	     * @param format The format of the time.		 */		public function setValue(value:Number, format:String = Time.FORMAT_MILLISECONDS):void		{			if (value == Number.NEGATIVE_INFINITY)			{				value = Number.NEGATIVE_INFINITY;			}			else if (value == Number.POSITIVE_INFINITY)			{				value = Number.MAX_VALUE;			}						switch (format)			{				case Time.FORMAT_YEARS:					_ms = value * TimeUnit.YEAR;					break;				case Time.FORMAT_DAYS:					_ms = value * TimeUnit.DAY;					break;				case Time.FORMAT_HOURS:					_ms = value * TimeUnit.HOUR;					break;				case Time.FORMAT_MINUTES:					_ms = value * TimeUnit.MINUTE;					break;				case Time.FORMAT_SECONDS:					_ms = value * TimeUnit.SECOND;					break;				default:					_ms = value;			}						_doEval = true;		}						/**		 * Adds the specified time to the current time.		 *  		 * @param time The time difference to be added to the current time.		 * @return A new instance with the resulting amount of time.		 */		public function plus(time:Time):Time		{			return new Time(_ms + time.valueOf());		}						/**		 * Subtracts the specified time from the current time.		 *  		 * @param time The time difference to be subtracted from the current time.		 * @return A new instance with the resulting amount of time.		 */		public function minus(time:Time):Time		{			return new Time(_ms - time.valueOf());		}						/**		 * Returns the amount of milliseconds that are contained within the time.		 * If the decimals parameter is 0 it will not round the resulting value.		 * 		 * @param decimals The number of decimal spaces that the returned time has.		 * @return The time difference in milliseconds.		 */		public function getMilliSeconds(decimals:int = 0):Number		{			if (_doEval) evaluate();			return Time.floor(_milliSeconds, decimals);		}						/**		 * Returns the amount of seconds that are contained within the time.		 * If the decimals parameter is 0 it will not round the resulting value.		 * 		 * @param decimals The number of decimal spaces that the returned time has.		 * @return The time difference in seconds.		 */		public function getSeconds(decimals:int = 0):Number		{			if (_doEval) evaluate();			return Time.floor(_seconds, decimals);		}						/**		 * Returns the amount of minutes that are contained within the time.		 * If the decimals parameter is 0 it will not round the resulting value.		 * 		 * @param decimals The number of decimal spaces that the returned time has.		 * @return The time difference in minutes.		 */		public function getMinutes(decimals:int = 0):Number		{			if (_doEval) evaluate();			return Time.floor(_minutes, decimals);		}						/**		 * Returns the amount of hours that are contained within the time.		 * If the decimals parameter is 0 it will not round the resulting value.		 * 		 * @param decimals The number of decimal spaces that the returned time has.		 * @return The time difference in hours.		 */		public function getHours(decimals:int = 0):Number		{			if (_doEval) evaluate();			return Time.floor(_hours, decimals);		}						/**		 * Returns the amount of days that are contained within the time.		 * If the decimals parameter is 0 it will not round the resulting value.		 * 		 * @param decimals The number of decimal spaces that the returned time has.		 * @return The time difference in days.		 */		public function getDays(decimals:int = 0):Number		{			if (_doEval) evaluate();			return Time.floor(_days, decimals);		}						/**		 * Returns the amount of years that are contained within the time.		 * If the decimals parameter is 0 it will not round the resulting value.		 * 		 * @param decimals The number of decimal spaces that the returned time has.		 * @return The time difference in years.		 */		public function getYears(decimals:int = 0):Number		{			if (_doEval) evaluate();			return Time.floor(_years, decimals);		}						/**		 * Returns the value of the time in milliseconds.		 * 		 * @return The time value in milliseconds.		 */		public function valueOf():Number		{			return _ms;		}						/**		 * Returns a well formatted String representation of the time value.		 * @return The time difference as string.		 */		public function toString():String		{			var result:String;			var value:Number = valueOf();						if (value < TimeUnit.SECOND)				result = getMilliSeconds() + TimeUnit.SYMBOL_MILLISECOND;			else if (value < TimeUnit.MINUTE)				result = getSeconds() + TimeUnit.SYMBOL_SECOND;			else if (value < TimeUnit.HOUR)				result = getMinutes(2) + TimeUnit.SYMBOL_MINUTE;			else if (value < TimeUnit.DAY)				result = getHours(2) + TimeUnit.SYMBOL_HOUR;			else if (value < TimeUnit.YEAR)				result = getDays(2) + TimeUnit.SYMBOL_DAY;			else				result = getYears(2) + TimeUnit.SYMBOL_YEAR;						return result;		}						//-----------------------------------------------------------------------------------------		// Getters & Setters		//-----------------------------------------------------------------------------------------				/**		 * Returns the value of Time in milliseconds.		 */		public function get milliseconds():Number		{			return valueOf();		}				/**		 * Returns the value of Time in seconds.		 */		public function get seconds():Number		{			return (_ms / TimeUnit.SECOND);		}				/**		 * Returns the value of Time in minutes.		 */		public function get minutes():Number		{			return (_ms / TimeUnit.MINUTE);		}				/**		 * Returns the value of Time in hours.		 */		public function get hours():Number		{			return (_ms / TimeUnit.HOUR);		}				/**		 * Returns the value of Time in days.		 */		public function get days():Number		{			return (_ms / TimeUnit.DAY);		}				/**		 * Returns the value of Time in years.		 */		public function get years():Number		{			return (_ms / TimeUnit.YEAR);		}						//-----------------------------------------------------------------------------------------		// Private Methods		//-----------------------------------------------------------------------------------------				/**		 * Splits the time value from ms (source value) into the different units.		 * @private		 */		protected function evaluate():void		{			var negative:int = (_ms >= 0) ? 1 : -1;			var rest:Number = _ms;						_years = rest / TimeUnit.YEAR;			rest -= negative * Math.floor(_years) * TimeUnit.YEAR;						_days = rest / TimeUnit.DAY;			rest -= negative * Math.floor(_days) * TimeUnit.DAY;						_hours = rest / TimeUnit.HOUR;			rest -= negative * Math.floor(_hours) * TimeUnit.HOUR;						_minutes = rest / TimeUnit.MINUTE;			rest -= negative * Math.floor(_minutes) * TimeUnit.MINUTE;						_seconds = rest / TimeUnit.SECOND;			rest -= negative * Math.floor(_seconds) * TimeUnit.SECOND;						_milliSeconds = rest;			_doEval = false;		}						/**		 * Used internally by the class to round values.		 * @private		 */		protected static function floor(n:Number, dec:int = 0):Number		{			var r:Number = Math.pow(10, dec);			return Math.floor(n * r) / r;		}	}}